/*! lasertutor 11-06-2014 */
(function(){var a,b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};c=null!=c?c:this,e=function(a,b){return null==b&&(b=d),c[a]=b,window[a]=b},d={},e("DOGWOOD",d),b=function(){var b,c;return b=document.createElementNS("http://www.w3.org/2000/svg","svg"),b.setAttribute("style","width: 600px; height:500px;"),document.getElementById("svgDiv").appendChild(b),c=new a({el:b})},a=function(a){function b(a){this.textClick=f(this.textClick,this),this.circleClick=f(this.circleClick,this),this.spinIn=f(this.spinIn,this),this.spinOut=f(this.spinOut,this),this.retractFlagpole=f(this.retractFlagpole,this),this.getRetractedLinePoints=f(this.getRetractedLinePoints,this),this.hideCallback=f(this.hideCallback,this),this.hide=f(this.hide,this),this.hideChildren=f(this.hideChildren,this),this.showChildren=f(this.showChildren,this),this.animateCircle=f(this.animateCircle,this),this.makeCircle=f(this.makeCircle,this),this.animateText=f(this.animateText,this),this.makeText=f(this.makeText,this),this.animateLine=f(this.animateLine,this),this.makeLine=f(this.makeLine,this),this.numDescendants=f(this.numDescendants,this),this.getLinePoints=f(this.getLinePoints,this),this.updatePosition=f(this.updatePosition,this),this.updateChildren=f(this.updateChildren,this),this.initialize=f(this.initialize,this),this.moveChildren=f(this.moveChildren,this),this.updateChild=f(this.updateChild,this),this.newChild=f(this.newChild,this),this.register=f(this.register,this),this.new_child=f(this.new_child,this);var c,d,e,g,h,i,j,k,l;this.children=[],this.hidden=[],this.referenceChildren=[],null==a.parent?(this.x=null!=(c=a.x)?c:5,this.y=null!=(d=a.y)?d:40,this.indent=null!=(e=a.indent)?e:40,this.textDX=null!=(g=a.textDX)?g:5,this.textDY=null!=(h=a.textDY)?h:-10,this.circleRadius=null!=(i=a.circleRadius)?i:4,this.circleDY=null!=(j=a.circleDY)?j:0,this.nodeHeight=null!=(k=a.nodeHeight)?k:35,this.flagpoleLength=this.circleDY+this.circleRadius,this.isRoot=!0):(this.parent=a.parent,this.parent.register(this)),this.name=null!=(l=a.text)?l:"Root",b.__super__.constructor.call(this,a)}return h(b,a),b.prototype.svgElement=function(a,b){var c,d,e;null==b&&(b={}),d=document.createElementNS("http://www.w3.org/2000/svg",a),null==b.version&&(b.version="1.1"),null==b.xmlns&&(b.xmlns="http://www.w3.org/2000/svg");for(c in b)e=b[c],d.setAttribute(c,e);return d},b.prototype.new_child=function(a){var c,d,e;return null==a&&(a="child"),e={transform:"translate("+this.indent+", 0)"},d=this.svgElement("g",e),c=this.svgElement("g"),d.appendChild(c),this.el.appendChild(d),new b({el:c,parent:this,text:a}),this.trigger("new_child"),this.isRoot?this.updatePosition():void 0},b.prototype.register=function(a){return this.children.push(a),this.referenceChildren.push(a),this.updateChildren(),this.listenTo(a,"new_child",this.newChild)},b.prototype.newChild=function(){return this.trigger("new_child"),this.isRoot?this.updatePosition():void 0},b.prototype.updateChild=function(a,b){return a.x=this.x+this.indent,a.y=this.y+this.nodeHeight*b,a.indent=this.indent,a.textDX=this.textDX,a.textDY=this.textDY,a.circleRadius=this.circleRadius,a.circleDY=this.circleDY,a.nodeHeight=this.nodeHeight,a.flagpoleLength=this.circleDY+this.circleRadius},b.prototype.moveChildren=function(){var a,b,c,d,e;for(d=this.children,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.updatePosition());return e},b.prototype.initialize=function(){return this.line=this.makeLine(),this.circle=this.makeCircle(),this.circle.addEventListener("click",this.circleClick),this.text=this.makeText(),this.text.addEventListener("click",this.textClick),this.el.appendChild(this.line),this.el.appendChild(this.circle),this.el.appendChild(this.text)},b.prototype.updateChildren=function(){var a,b,c,d,e,f;for(b=0,e=this.children,f=[],c=0,d=e.length;d>c;c++)a=e[c],b+=1,this.updateChild(a,b),f.push(b+=a.numDescendants());return f},b.prototype.updatePosition=function(){return this.updateChildren(),this.moveChildren(),this.animateLine(),this.animateText(),this.animateCircle()},b.prototype.getLinePoints=function(){var a,b;return this.priorLinePoints=this.linePoints,a=this.children[this.children.length-1],b=a?a.numDescendants():0,this.flagpoleLength=(this.numDescendants()-b)*this.nodeHeight,this.linePoints="0 "+this.y+" "+this.indent+" "+this.y+" ",this.linePoints+=""+this.indent+" "+(this.y+this.flagpoleLength),null==this.priorLinePoints&&(this.priorLinePoints=this.linePoints),this.linePoints},b.prototype.numDescendants=function(){var a,b,c,d,e;for(b=0,e=this.children,c=0,d=e.length;d>c;c++)a=e[c],b+=a.numDescendants();return b+this.children.length},b.prototype.makeLine=function(){return this.svgElement("polyline",{fill:"none",points:this.getLinePoints(),"stroke-width":"2px",stroke:"blue"})},b.prototype.animateLine=function(){var a,b;return b={attributeName:"points",to:this.getLinePoints(),from:this.priorLinePoints,dur:"0.4s",repeatCount:1,begin:"indefinite",fill:"freeze"},a=this.svgElement("animate",b),this.line.appendChild(a),a.beginElement()},b.prototype.makeText=function(){var a;return this.textX=this.textDX,this.textY=this.y+this.textDY,a=this.svgElement("text",{fill:"black",x:this.textDX,y:this.y+this.textDY}),a.appendChild(document.createTextNode(this.name)),a},b.prototype.animateText=function(){var a,b;return b={attributeName:"y",to:this.y+this.textDY,from:this.textY,dur:"0.4s",repeatCount:1,begin:"indefinite",fill:"freeze"},this.textY=this.y+this.textDY,a=this.svgElement("animate",b),this.text.appendChild(a),a.beginElement()},b.prototype.makeCircle=function(){return this.circleX=this.indent,this.circleY=this.y+this.circleDY,this.svgElement("circle",{fill:"blue",cx:this.indent,cy:this.y+this.circleDY,r:this.circleRadius,"stroke-width":"2px",stroke:"blue"})},b.prototype.animateCircle=function(){var a,b;return b={attributeName:"cy",to:this.y+this.circleDY,from:this.circleY,dur:"0.4s",repeatCount:1,begin:"indefinite",fill:"freeze"},this.circleY=this.y+this.circleDY,a=this.svgElement("animate",b),this.circle.appendChild(a),a.beginElement()},b.prototype.showChildren=function(){var a,b,c,d,e,f,g,h,j,k;for(d=this.children.concat(this.hidden),c=[],j=this.referenceChildren,e=0,g=j.length;g>e;e++)a=j[e],i.call(d,a)>=0&&c.push(a);for(this.children=c,this.updateChildren(),this.hidden=[],k=this.children,f=0,h=k.length;h>f;f++)b=k[f],b.spinIn();return this.trigger("new_child"),this.isRoot?this.updatePosition():void 0},b.prototype.hideChildren=function(){var a,b,c,d,e,f;for(b=this.hideCallback(function(a){return function(){return a.trigger("new_child")}}(this)),this.isRoot&&(b=this.hideCallback(this.updatePosition)),e=this.children,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(a.hide(b));return f},b.prototype.hide=function(a){var b,c,d,e,f,g;for(0===this.children.length&&this.spinOut(function(b){return function(){return a(b)}}(this)),b=this.hideCallback(function(b){return function(){return b.retractFlagpole(function(){return b.spinOut(function(){return a(b)})})}}(this)),f=this.children,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.hide(b));return g},b.prototype.hideCallback=function(a){return function(b){return function(c){var d;return b.hidden.push(c),d=b.children.indexOf(c),b.children.splice(d,1),0===b.children.length?a():void 0}}(this)},b.prototype.getRetractedLinePoints=function(){return"0 "+this.y+" "+this.indent+" "+this.y+" "+this.indent+" "+this.y},b.prototype.retractFlagpole=function(a){var b,c;return c={attributeName:"points",from:this.priorLinePoints,to:this.getRetractedLinePoints(),dur:"0.4s",repeatCount:1,begin:"indefinite",fill:"freeze"},b=this.svgElement("animate",c),this.line.appendChild(b),null!=a&&b.addEventListener("endEvent",a),b.beginElement()},b.prototype.spinOut=function(a){var b,c;return c={attributeName:"transform",type:"scale",from:"1 1",to:"0 1",dur:"0.4s",repeatCount:1,begin:"indefinite",fill:"freeze"},b=this.svgElement("animateTransform",c),this.el.appendChild(b),null!=a&&b.addEventListener("endEvent",a),b.beginElement()},b.prototype.spinIn=function(a){var b,c;return this.circleY=this.y+this.circleDY,this.circle.setAttribute("cy",this.circleY),this.textY=this.y+this.textDY,this.text.setAttribute("y",this.textY),this.priorLinePoints=this.getLinePoints(),this.line.setAttribute("points",this.priorLinePoints),c={attributeName:"transform",type:"scale",from:"0 1",to:"1 1",dur:"0.4s",repeatCount:1,begin:"indefinite",fill:"freeze"},b=this.svgElement("animateTransform",c),this.el.appendChild(b),null!=a&&b.addEventListener("endEvent",a),b.beginElement()},b.prototype.circleClick=function(){return this.new_child()},b.prototype.textClick=function(){return 0!==this.hidden.length?this.showChildren():this.hideChildren()},b}(Backbone.View),d.SVGNodeView=a,d.drawSVG=b}).call(this),this.JST=this.JST||{},this.JST.Euler=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="Euler">\n    <span class="name">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</span>\n    <div class="Euler-element">\n        <span class="Euler-label">'+k((f=b&&b._order,f=null==f||f===!1?f:f[0],typeof f===j?f.apply(b):f))+':</span>\n        <span class="Euler-data">'+k((g=c.sig||b&&b.sig,h={hash:{},data:e},g?g.call(b,4,b&&b._x,h):l.call(b,"sig",4,b&&b._x,h)))+'</span>\n    </div>\n    <div class="Euler-element">\n        <span class="Euler-label">'+k((f=b&&b._order,f=null==f||f===!1?f:f[1],typeof f===j?f.apply(b):f))+':</span>\n        <span class="Euler-data">'+k((g=c.sig||b&&b.sig,h={hash:{},data:e},g?g.call(b,4,b&&b._z,h):l.call(b,"sig",4,b&&b._z,h)))+'</span>\n    </div>\n    <div class="Euler-element">\n        <span class="Euler-label">'+k((f=b&&b._order,f=null==f||f===!1?f:f[2],typeof f===j?f.apply(b):f))+':</span>\n        <span class="Euler-data">'+k((g=c.sig||b&&b.sig,h={hash:{},data:e},g?g.call(b,4,b&&b._z,h):l.call(b,"sig",4,b&&b._z,h)))+"</span>\n    </div>\n</div>\n\n"}),this.JST.Matrix4=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+="\n        <tr>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[0],e):j.call(a,"sig",4,a&&a[0],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[4],e):j.call(a,"sig",4,a&&a[4],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[8],e):j.call(a,"sig",4,a&&a[8],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[12],e):j.call(a,"sig",4,a&&a[12],e)))+"</td>\n        </tr>\n        <tr>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[1],e):j.call(a,"sig",4,a&&a[1],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[5],e):j.call(a,"sig",4,a&&a[5],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[9],e):j.call(a,"sig",4,a&&a[9],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[13],e):j.call(a,"sig",4,a&&a[13],e)))+"</td>\n        </tr>\n        <tr>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[2],e):j.call(a,"sig",4,a&&a[2],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[6],e):j.call(a,"sig",4,a&&a[6],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[10],e):j.call(a,"sig",4,a&&a[10],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[14],e):j.call(a,"sig",4,a&&a[14],e)))+"</td>\n        </tr>\n        <tr>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[3],e):j.call(a,"sig",4,a&&a[3],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[7],e):j.call(a,"sig",4,a&&a[7],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[11],e):j.call(a,"sig",4,a&&a[11],e)))+"</td>\n            <td>"+k((d=c.sig||a&&a.sig,e={hash:{},data:b},d?d.call(a,4,a&&a[15],e):j.call(a,"sig",4,a&&a[15],e)))+"</td>\n        </tr>\n        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function",m=this;return i+='<div class="Matrix4">\n    <span class="name">',(h=c.name)?g=h.call(b,{hash:{},data:e}):(h=b&&b.name,g=typeof h===l?h.call(b,{hash:{},data:e}):h),i+=k(g)+'</span>\n    <table class="matrix">\n        ',g=c["with"].call(b,b&&b.elements,{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+="\n    </table>\n</div>\n"}),this.JST.Object3D=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n            <span class="name">',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"</span>\n            "}function g(){return'\n            <span class="name">Object3D</span>\n            '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j="",k="function",l=this.escapeExpression,m=this;return j+='<div class="Object3D-grid">\n    <div class="left">\n        <div class="title">\n            ',h=c["if"].call(b,b&&b.name,{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e}),(h||0===h)&&(j+=h),j+="\n            ",h=c.unless.call(b,b&&b.name,{hash:{},inverse:m.noop,fn:m.program(3,g,e),data:e}),(h||0===h)&&(j+=h),j+='\n            <br /><span class="parent">Parent: ',(i=c.parent)?h=i.call(b,{hash:{},data:e}):(i=b&&b.parent,h=typeof i===k?i.call(b,{hash:{},data:e}):i),j+=l(h)+'</span>\n        </div>\n        <div class="vectors">\n            <div class="grid-box-Vector3">\n                ',(i=c.position)?h=i.call(b,{hash:{},data:e}):(i=b&&b.position,h=typeof i===k?i.call(b,{hash:{},data:e}):i),(h||0===h)&&(j+=h),j+='\n            </div>\n            <div class="grid-box-Euler">\n                ',(i=c.rotation)?h=i.call(b,{hash:{},data:e}):(i=b&&b.rotation,h=typeof i===k?i.call(b,{hash:{},data:e}):i),(h||0===h)&&(j+=h),j+='\n            </div>\n        </div>\n    </div>\n    <div class="grid-box-Matrix4">\n        ',(i=c.matrix)?h=i.call(b,{hash:{},data:e}):(i=b&&b.matrix,h=typeof i===k?i.call(b,{hash:{},data:e}):i),(h||0===h)&&(j+=h),j+='\n    </div>\n    <div class="grid-box-Matrix4">\n        ',(i=c.matrixWorld)?h=i.call(b,{hash:{},data:e}):(i=b&&b.matrixWorld,h=typeof i===k?i.call(b,{hash:{},data:e}):i),(h||0===h)&&(j+=h),j+="\n    </div>\n</div>\n"}),this.JST.Vector3=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="Vector3">\n    <span class="name">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</span>\n    <div class="Vector3-element">\n        <span class="Vector3-label">X:</span>\n        <span class="Vector3-data">'+k((g=c.sig||b&&b.sig,h={hash:{},data:e},g?g.call(b,4,b&&b.x,h):l.call(b,"sig",4,b&&b.x,h)))+'</span>\n    </div>\n    <div class="Vector3-element">\n        <span class="Vector3-label">Y:</span>\n        <span class="Vector3-data">'+k((g=c.sig||b&&b.sig,h={hash:{},data:e},g?g.call(b,4,b&&b.y,h):l.call(b,"sig",4,b&&b.y,h)))+'</span>\n    </div>\n    <div class="Vector3-element">\n        <span class="Vector3-label">Z:</span>\n        <span class="Vector3-data">'+k((g=c.sig||b&&b.sig,h={hash:{},data:e},g?g.call(b,4,b&&b.z,h):l.call(b,"sig",4,b&&b.z,h)))+"</span>\n    </div>\n</div>\n"}),function(){var a,b,c,d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}},k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=null!=f?f:this,i=function(a,b){return f[a]=b,window[a]=b},h={},i("lasertutor",h),e=function(){function a(){}return a.prototype.normalizeMouseTravel=function(a,b,c,d){var e,f;return e=d.x-c.x,f=c.y-d.y,{x:e/a,y:f/b}},a.prototype.calculateRotationVector=function(a,b,c,d){var e;return null==c&&(c=2*Math.PI),null==d&&(d=1),b*=d,e=0===b?c:c/b,{yaw:a.x*e,pitch:a.y*e}},a.prototype.clampAngle0_2PI=function(a){return a%=2*Math.PI,a>0?a:2*Math.PI+a},a.prototype.mouseXYToCameraRotation=function(a,b,c,d){var e,f,g,h,i,j,k;return g=Math.sqrt(a*a+b*b),j=g*d,h=b/g,i=Math.sin(j),f=Math.cos(j),k=1-f,e={z:-a/g,x:Math.cos(c)*h,y:-Math.sin(c)*h},new THREE.Matrix4(e.x*e.x*k+f,e.x*e.y*k-e.z*i,e.x*e.z*k+i*e.y,0,e.y*e.x*k+e.z*i,e.y*e.y*k+f,e.y*e.z*k-e.x*i,0,e.z*e.x*k-e.y*i,e.y*e.z*k+e.x*i,e.z*e.z*k+f,0,0,0,0,1)},a.prototype.pitchRotationAxis=function(a){return new THREE.Vector3(Math.cos(a),-Math.sin(a),0)},a}(),h.ThreeDNavController=e,c=function(){function a(a){this.element=a,this.getMouseXY=j(this.getMouseXY,this),this.getTouchXY=j(this.getTouchXY,this),this.touchEnd=j(this.touchEnd,this),this.touchStart=j(this.touchStart,this),this.mouseUp=j(this.mouseUp,this),this.mouseDown=j(this.mouseDown,this),this.startPoint={x:50,y:50},this.interacting=!1,this.element.addEventListener("mousedown",this.mouseDown),window.addEventListener("mouseup",this.mouseUp),this.element.addEventListener("mousemove",this.mouseMove),this.element.addEventListener("wheel",this.mouseWheel),this.element.addEventListener("touchstart",this.touchStart),window.addEventListener("touchend",this.touchEnd),this.element.addEventListener("touchmove",this.touchMove)}return a.prototype.mouseDown=function(a){return this.interacting=!0,this.startPoint=this.getMouseXY(a)},a.prototype.mouseWheel=function(){},a.prototype.mouseUp=function(){return this.interacting=!1},a.prototype.touchStart=function(a){return this.interacting=!0,this.startPoint=this.getTouchXY(a)},a.prototype.touchEnd=function(){return this.interacting=!1},a.prototype.getTouchXY=function(a){var b;return b=this.element.getBoundingClientRect(),{x:a.targetTouches[0].clientX-b.left,y:a.targetTouches[0].clientY-b.top}},a.prototype.getMouseXY=function(a){var b;return b=this.element.getBoundingClientRect(),{x:a.clientX-b.left,y:a.clientY-b.top}},a}(),h.NavigationUI=c,b=function(a){function b(a){var c,e;this.element=a,this.renderTHREE=j(this.renderTHREE,this),this.mouseWheel=j(this.mouseWheel,this),this.revolveCamera=j(this.revolveCamera,this),this.mouseMove=j(this.mouseMove,this),this.touchStart=j(this.touchStart,this),this.mouseDown=j(this.mouseDown,this),this.ZOOMFACTOR=-.3,this.MIN_ZOOM=.01,this.RADIANS_PER_FRAME_UNIT=Math.PI,b.__super__.constructor.call(this,this.element),this.yaw=0,this.pitch=0,this.scene=new THREE.Scene,c=new THREE.CylinderGeometry(.4,.4,.2,16),e=new THREE.MeshBasicMaterial({color:16776960}),this.focalPoint=new THREE.Mesh(c,e),this.view=new d({model:this.focalPoint,name:"focalPoint",parent:"world"}),this.view.render(),document.body.appendChild(this.view.el),this.scene.add(this.focalPoint),this.camera=new THREE.PerspectiveCamera(75,1,.1,1e3),this.camera.position.z=5,this.focalPoint.add(this.camera),this.startCameraMatrix=this.camera.matrix.clone(),this.renderer=new THREE.WebGLRenderer,this.element.appendChild(this.renderer.domElement),this.renderer.setSize(500,500),this.interactionRegime=this.revolveCamera,this.controller=new lasertutor.ThreeDNavController}return l(b,a),b.prototype.mouseDown=function(a){return b.__super__.mouseDown.call(this,a),this.startFocalRotation=this.focalPoint.rotation.clone(),this.interactionRegime=function(){switch(a.button){case 0:return function(a){return this.revolveCamera(this.getMouseXY(a))};case 4:return function(a){return this.translateFocalPoint(this.getMouseXY(a))}}}()},b.prototype.touchStart=function(a){return b.__super__.touchStart.call(this,a),this.startFocalRotation=this.focalPoint.rotation.clone(),this.interactionRegime=function(){switch(a.targetTouches.length){case 1:return function(a){return this.revolveCamera(this.getTouchXY(a))};case 2:return this.zoom;case 3:return function(a){return this.translateFocalPoint(this.getTouchXY(a))}}}.call(this)},b.prototype.mouseMove=function(a){return this.interacting?this.interactionRegime(a):void 0},b.prototype.revolveCamera=function(a){var b,c,d,e,f;return d=this.pitch,e=this.yaw,b=this.controller.normalizeMouseTravel(this.element.offsetWidth,this.element.offsetHeight,this.startPoint,a),c=this.controller.pitchRotationAxis(this.yaw),this.yaw=this.controller.clampAngle0_2PI(this.yaw+this.RADIANS_PER_FRAME_UNIT*b.x),this.pitch+=this.RADIANS_PER_FRAME_UNIT*b.y,this.pitch=this.pitch>Math.PI?Math.PI:this.pitch,this.pitch=this.pitch<0?0:this.pitch,this.focalPoint.rotation.x+=c.x*(this.pitch-d),this.focalPoint.rotation.y+=c.y*(this.pitch-d),this.focalPoint.rotation.z-=this.yaw-e,f=this.controller.mouseXYToCameraRotation(b.x,b.y,this.yaw,this.RADIANS_PER_FRAME_UNIT),this.startPoint=a,this.view.render()},b.prototype.mouseWheel=function(a){var b;return a.preventDefault(),b=this.camera.position.z+this.ZOOMFACTOR*-a.deltaY,this.camera.position.z=b>=this.MIN_ZOOM?b:this.MIN_ZOOM},b.prototype.renderTHREE=function(){return requestAnimationFrame(this.renderTHREE),this.renderer.render(this.scene,this.camera)},b.prototype.add=function(a){return this.scene.add(a)},b}(c),h.NavigableScene=b,a=function(){function a(){var a,b,c,d,e,f;b=new THREE.LineBasicMaterial({color:255}),a=new THREE.Geometry,a.vertices.push(new THREE.Vector3(-100,0,0)),a.vertices.push(new THREE.Vector3(100,0,0)),this.x_axis=new THREE.Line(a,b),d=new THREE.LineBasicMaterial({color:65280}),c=new THREE.Geometry,c.vertices.push(new THREE.Vector3(0,-100,0)),c.vertices.push(new THREE.Vector3(0,100,0)),this.y_axis=new THREE.Line(c,d),f=new THREE.LineBasicMaterial({color:16711680}),e=new THREE.Geometry,e.vertices.push(new THREE.Vector3(0,0,-100)),e.vertices.push(new THREE.Vector3(0,0,100)),this.z_axis=new THREE.Line(e,f)}return a.prototype.addTo=function(a){var b,c,d;for(a.add(this.x_axis),b=c=-100;100>=c;b=c+=10)a.add(this.xLine(b));for(a.add(this.y_axis),b=d=-100;100>=d;b=d+=10)a.add(this.yLine(b));return a.add(this.z_axis)},a.prototype.xLine=function(a){var b,c;return c=new THREE.LineBasicMaterial({color:255}),b=new THREE.Geometry,b.vertices.push(new THREE.Vector3(-100,a,0)),b.vertices.push(new THREE.Vector3(100,a,0)),new THREE.Line(b,c)},a.prototype.yLine=function(a){var b,c;return c=new THREE.LineBasicMaterial({color:65280}),b=new THREE.Geometry,b.vertices.push(new THREE.Vector3(a,-100,0)),b.vertices.push(new THREE.Vector3(a,100,0)),new THREE.Line(b,c)},a}(),h.Axes=a,d=function(a){function b(a){this.render=j(this.render,this),b.__super__.constructor.call(this,a),this.name=a.name,this.parent=a.parent,this.template=JST.Object3D,this.model.position.name="Position",this.model.rotation.name="Rotation",this.model.matrix.name=".matrix",this.model.matrixWorld.name=".matrixWorld"}return l(b,a),b.prototype.render=function(){return this.el.innerHTML=this.template({name:this.name,parent:this.parent,matrix:JST.Matrix4(this.model.matrix),matrixWorld:JST.Matrix4(this.model.matrixWorld),position:JST.Vector3(this.model.position),rotation:JST.Euler(this.model.rotation)})},b}(Backbone.View),h.Object3DView=d,g=function(a,b){return b.toFixed(a)},Handlebars.registerHelper("sig",g)}.call(this);